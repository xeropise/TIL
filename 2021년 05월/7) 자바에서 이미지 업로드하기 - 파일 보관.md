- 이미지 파일을 저장하는 방법에는 데이터베이스 [BLOB](https://dev.mysql.com/doc/refman/8.0/en/blob.html) 형식으로 저장하거나, 파일 형태로 저장하는 2가지 방법으로 나뉘는데 '뭐가 더 나은 방법인가' 에 대해서 논할수도 있겠지만 이미 그에 대해서 [스택오버플로우](https://stackoverflow.com/questions/348363/what-is-the-best-place-for-storing-uploaded-images-sql-database-or-disk-file-sy)에서 이미 논했으므로 나는 파일 형태로 보관하는 방법으로 구현하기로 했다.

- 스프링으로 Multipart/form 요청을 받으려면 Handler의 메소드 인자로 [MultiPartFile](https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/web/multipart/MultipartFile.html) 로 받아 올 수 있는데, 이를 사용하려면 DispatcherServlet 에서 MultiPartResolver 가 빈으로 등록되어야 한다.

- Springframework 는 [CommonsMultipartResolver](https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/web/multipart/commons/CommonsMultipartResolver.html) 라는 bean 을 제공하며, SpringBoot 의 경우 MultipartAutoConfiguration 클래스에 의해 자동으로 설정 된다.

![다운로드 (1)](https://user-images.githubusercontent.com/50399804/119229278-28229700-bb52-11eb-953e-f9a3c01b864c.png)

- 상세 Property 들은 Application.properties 에서 커스터마이징 가능하다

![다운로드 (2)](https://user-images.githubusercontent.com/50399804/119229335-7d5ea880-bb52-11eb-9da3-97fa8d1a45fc.png)

```
spring.servlet.multipart.max-file-size=128KB
spring.servlet.multipart.max-request-size=128KB
```

```java
@PostMapping("/url")
public String imageUpload(MultipartFile Image) {

        //파일명
        String originalFile = Image.getOriginalFilename();
        //파일명 중 확장자만 추출                                                //lastIndexOf(".") - 뒤에 있는 . 의 index번호
        String originalFileExtension = originalFile.substring(originalFile.lastIndexOf("."));


        //업무에서 사용하는 리눅스, UNIX는 한글지원이 안 되는 운영체제
        //파일업로드시 파일명은 ASCII코드로 저장되므로, 한글명으로 저장 필요
        //UUID클래스 - (특수문자를 포함한)문자를 랜덤으로 생성                    "-"라면 생략으로 대체
        String storedFileName = UUID.randomUUID().toString().replaceAll("-", "") + originalFileExtension;

        //파일을 저장하기 위한 파일 객체 생성
        file = new File(filePath + storedFileName);
        //파일 저장
        Image.transferTo(file);
}
```
