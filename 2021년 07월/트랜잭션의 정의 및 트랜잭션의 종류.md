## 트랜잭션(Transaction) 개념

- 한 묶음으로 처리되어야 하는 SQL 명령문들의 집합을 말한다. 트랜잭션에 속한 SQL 명령문들은 모두 정상 처리되어야 함께 완료된다. 하나의 명령문이라도 오류가 발생하면 전체 취소

- 여러가지 SQL 명령문을 트랜잭션으로 묶으려면 START TRANSACTION 명령문으로 묶을 수 있다. COMMIT 되기 전까지 트랜잭션의 실행 결과를 데이터베이스에 최종 반영할 수 없으며, 실행 결과를 반영하지 않고 취소하려면 ROLLBACK 명령어를 사용하면 된다.

```SQL
START TRANSACTION
SELECT * FROM A;
DELETE FROM A WHERE NAME='name';
SELECT * FROM B;
COMMIT;
--ROLLBACK;
```

- 트랜잭션 은 데이터베이스에서 가장 중요한 개념 중 하나이다. 데이터베이스에서 SQL 처리를 위한 작업 단위로 트랜잭션 개념을 도입한 이유는 복수 사용자의 **동시 접근성을 제어**하고 **장애 발생 시 안정적으로 데이터 복구를 하기 위해서이다.** <br>

  (데이터베이스 장애 -> 서버나 저장 장치, 네트워크의 고장, 자연 재해, 해킹)

---

## Transaction 의 특성 (ACID)

1. 원자성 (Atomicity)

- 트랜잭션 안의 SQL 명령문을 모두 성공적으로 실행하거나 아니면 모두 취소해야 한다.

- 장애가 발생한다면 장애 발생 시점에 이미 정상 완료되어 커밋된 트랜잭션을 제외하고 완료되지 않은 트랜잭션은 모두 취소 시켜야 한다.

<br>

2. 일관성 (Consistency)

- 데이터베이스가 트랜잭션 실행 전의 일관된 상태에서 트랜잭션 실행 후에도 또 다른 일관된 상태로 전환되어야 함을 말한다.

- 트랜잭션 시작 전과 커밋 후에도 항상 데이터의 일관성이 유지되어야 한다.

- 동시 실행되는 트랜잭션 사이의 상호 간섭을 Lock 과 같은 방법을 통해 데이터의 일관성을 유지 시킬 수 있다.

<br>

3. 고립성 (Isolation)

- Commit이 완료될 때까지 트랜잭션이 수행한 임시 실행 결과가 다른 트랜잭션에게 영향을 주거나 받으면 안된다.

- 같은 데이터를 처리하는 다른 트랜잭션들의 간섭 방지를 위해 동시 실행중인 경우 각 트랜잭션이 Commit 되기 전까지 변경 내용을 Lock을 통해 고립시켜야 한다.

<br>

4. 지속성 (Durability)

- 트랜잭션이 Commit 되면 그 트랜잭션의 실행 결과가 장애가 발생하더라도 보존되어야 함을 말한다.

- Commit 된 트랜잭션 결과는 최종적으로 안정된 저장 장치에 반영되는 것을 보장하며 결코 손상되지 않아야 한다.

- 저장 장치가 손상되더라도 로그와 같은 실행 기록을 참조하여 손상 이전 상태로 회복 시켜야 한다.
